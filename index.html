<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
      integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
      crossorigin="anonymous"
    />
    <style>
      header {
        display: flex; 
        flex-direction: column;
        justify-content: center; 
        text-align: center;
        height: 70px;
        border-radius: 5px;
        background-color: rgb(66, 66, 70);
        font-family: Arial, Helvetica, sans-serif;
        font-size: 30px;
        font-weight: bold;
        color: white;
      }
      .container {
          border-style: solid;
      }
      label {
          display: block;
      }
      /* h1 {
        font-family: Arial, Helvetica, sans-serif;
        font-size: 20px;
        color: white;
      }
      .top-articles {
        font-family: Arial, Helvetica, sans-serif;
        font-weight: bold;
        font-size: 15px;
        background-color: rgb(226, 222, 222);
        height: 40px;
        padding: 7px;
      }
      label {
        font-family: Arial, Helvetica, sans-serif;
        font-weight: bold;
        font-size: 12px;
      }
      .form-container {
        border: solid 1px rgb(184, 183, 183);
        border-radius: 5px;
      }
      .p-abstract, .p-headline {
        font-family: Arial, Helvetica, sans-serif;
        font-size: 15px;
      } */
      .form-control {
          display: inline-flex;
          width: 60%;
      }
      .btn {
          margin-bottom: 3px;
          margin-left: 5px;
          background-color: blue;
          color: white;
      }
      .search-history {
          border: solid 1px rgb(241, 240, 240);
          background-color: white;
          display: block;
          margin-bottom: 0px;
          padding-top: 5px;
          padding-bottom: 5px;
      }
      .col-4, .col-8 {
          border: solid 1px rgb(211, 195, 195);
      }
      .col-4 {
          background-color: rgb(247, 242, 242);
      }
      .col-8 {
          padding-left: 5px;
          padding-right: 5px;
          padding-top: 5px;
          border: solid 1px rgb(211, 195, 195);
      }
      form {
          margin-bottom: 10px;
      }
      #one-day {
          margin: 10px 0px 20px 0px;
          border: solid 1px rgb(211, 195, 195);
          padding: 10px;
      }
      #five-days {
          display: flex;
          justify-content: space-between; 
          flex-wrap: wrap;
          border: solid 1px rgb(211, 195, 195);
          border-radius: 5px; 
      }
      .daily-five-days {
        display: flex;   
        flex-direction: column;
        border: solid 1px rgb(211, 195, 195);
        margin-bottom: 10px;
        background-color: blue;
        color: white;
      }
      /* #date-day1, #temp-day1, #humid-day1, #date-day2, #temp-day2, #humid-day2 { */
          /* display: flex; */
          /* flex-direction: column; */
      /* }    */
      .five-day-content, .five-day-date {
          padding: 5px;
          margin-bottom: 10px;
          font-size: 12px;
      }
      .five-day-date {
          font-size: 18px;
          font-weight: bold;
      }
      #current-uv-index {
          color: white;
          padding-left: 10px;
          padding-right: 10px;
      }
      img {
          height: 60px;
          width: 60px;
      }
    </style>
</head>
<body>
  <div class="container">
    <header class="row">
        Weather Dashboard
    </header>
  </div>
    <!-- </br> -->
  <div class="container form-container">
    <div class="row">
        <div class="col-4">
            <form>
                <label for="search-city" class="form-label">Search for a City:</label>
                <input class="form-control" type="text" id="search-city">
                 <button type="button" class="btn btn-outline-secondary" id="search-btn"><i class="fas fa-search"></i></button>
             </form>
             <p class="search-history">Austin</p>
             <p class="search-history">Chicago</p>
             <p class="search-history">New York</p>
        </div>
        <div class="col-8">
            <div id="one-day">
                <!-- City and Date Information will go here -->
                <h4 id="city-date"></h4>            
                <p id="current-temperature">Temperature:</p>
                <p id="current-humidity">Humidity:</p>
                <p id="current-wind-speed">Wind Speed:</p>
                <p>UV Index:  <span id="current-uv-index"></span></p>
            </div>
            <h4>5-Day Forecast:</h4>
            <div id="five-days">
                <!-- <div class="daily-five-days">
                    <p class="five-day-date" id="date-day1">8/16/2019</p>
                    <p class="five-day-content" id="temp-day1">Temp: 86.84</p>
                    <p class="five-day-content" id="humid-day1">Humidity: 43%</p>
                </div>
                <div class="daily-five-days">
                    <p class="five-day-date" id="date-day2">8/16/2019</p>
                    <p class="five-day-content" id="temp-day2">Temp: 86.84</p>
                    <p class="five-day-content"id="humid-day2">Humidity: 43%</p>
                </div>
                <div class="daily-five-days">
                    <p class="five-day-date" id="date-day3">8/16/2019</p>
                    <p class="five-day-content" id="temp-day3">Temp: 86.84</p>
                    <p class="five-day-content" id="humid-day3">Humidity: 43%</p>
                </div>
                <div class="daily-five-days">
                    <p class="five-day-date" id="date-day4">8/16/2019</p>
                    <p class="five-day-content" id="temp-day4">Temp: 86.84</p>
                    <p class="five-day-content" id="humid-day4">Humidity: 43%</p>
                </div>
                <div class="daily-five-days">
                    <p class="five-day-date" id="date-day5">8/16/2019</p>
                    <p class="five-day-content" id="temp-day5">Temp: 86.84</p>
                    <p class="five-day-content" id="humid-day5">Humidity: 43%</p>
                </div> -->
            </div>
        </div>
    </div>
    <!-- <div class="row">
        <p class="search-history">Austin</p>
        <p class="search-history">Chicago</p>
    </div> -->
  </div>
<!-- results container -->
  <!-- <div class="container">
    <div class="row">
      <p class="top-articles"><i class="far fa-file-alt"></i> Top Articles</p>
    </div>
    <div class="row" id="results-pad">

    </div>
  </div> -->
<body>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <script type="text/javascript">

    
    //  $("#search-btn").on("click", function() {
    //   var searchTerm = $("#search-term").val().trim();
    //   var queryURL = "https://api.nytimes.com/svc/search/v2/articlesearch.json?q=" + searchTerm + "&api-key=AsC4bHdCeUwjuG91cDolgevIkyHa3vkr"
    //   $.ajax({
    //     url: queryURL,
    //     method: "GET"
    //   }).then(function(response) {
    //     console.log(response);
    //    var newP = $("<p>");
    //   newP.addClass("p-headline");
    //   newP.text(response.response.docs[0].headline.print_headline);
    //   $("#results-pad").append(newP); 
    //   var newP2 = $("<p>");
    //   newP2.addClass("")
    //   });

    //   }); 

     // This is our API key. Add your own API key between the ""
     var APIKey = "eb971d001ccc0e5bf2880689819045f3";

// Here we are building the URL we need to query the database

function currentWeather(xTemp, xHumid, xWind, xUv){
var tempF = (xTemp - 273.15) * 9/5 + 32;
$("#current-temperature").text("Temperature:  " + tempF.toFixed(2) + String.fromCharCode(8457));
$("#current-humidity").text("Humidity:  " + xHumid + String.fromCharCode(37));
$("#current-wind-speed").text("Wind Speed:  " + xWind.toFixed(1) + "MPH");
$("#current-uv-index").text(xUv);

if (xUv >= 0 && xUv < 3){
    $("#current-uv-index").css("background-color", "green");
} 
else if (xUv >= 3 && xUv < 6) {
    $("#current-uv-index").css("background-color", "yellow");
}
else if (xUv >= 6 && xUv < 8){
    $("#current-uv-index").css("background-color", "orange");
}
else if (xUv >= 8 && xUv < 11){
    $("#current-uv-index").css("background-color", "red");
}
else {
    $("#current-uv-index").css("background-color", "violet");
}
}

function fiveDaysWeather(xDaily) {
    for (var i = 1; i <= 5; i++) {
        var newDiv = $("<div>");
        newDiv.addClass("daily-five-days");
        var newPDate = $("<p>");
        newPDate.addClass("five-day-date").attr("id", ("date-day" + i));
        var dtCurrent = new Date(xDaily[i].dt * 1000);
        var dtMonth = dtCurrent.getMonth();
        var dtDay = dtCurrent.getDate();
        var dtYear = dtCurrent.getFullYear();
        newPDate.text((dtMonth + 1) + "/" + dtDay + "/" + dtYear);
        var newIcon = $("<img>");
        newIcon.attr("src","http://openweathermap.org/img/wn/" + xDaily[i].weather[0].icon + "@2x.png");
        var newPTemp = $("<p>");
        newPTemp.addClass("five-day-content").attr("id", ("temp-day" + i));
        var tempF = (xDaily[i].temp.day - 273.15) * 9/5 + 32;
        newPTemp.text("Temp:  " + tempF.toFixed(2) + String.fromCharCode(8457));
        var newPHumid = $("<p>");
        newPHumid.addClass("five-day-content").attr("id", ("humid-day" + i));
        newPHumid.text("Humidity:  " + xDaily[i].humidity + String.fromCharCode(37));
        newDiv.append(newPDate).append(newIcon).append(newPTemp).append(newPHumid);
        $("#five-days").append(newDiv);
    }
}

function weatherQuery(xlon, xlat){
var queryURL2 = "https://api.openweathermap.org/data/2.5/onecall?lat=" + xlat + "&lon=" + xlon + "&exclude=hourly,minutely&appid=" + APIKey;
$.ajax({
  url: queryURL2,
  method: "GET"
}).then(function(response2) {
  console.log(response2);
  var currentTemp = response2.current.temp;
  var currentHumid = response2.current.humidity;
  var currentWind = response2.current.wind_speed;
  var currentUv = response2.current.uvi;
  // Function to extract current weather
  currentWeather(currentTemp, currentHumid, currentWind, currentUv);
  //Function to extract five days forecast
  fiveDaysWeather(response2.daily);
});
} 



var queryURL1 = "https://api.openweathermap.org/data/2.5/weather?q=Dumaguete&appid=" + APIKey;
// We then created an AJAX call
$.ajax({
  url: queryURL1,
  method: "GET"
}).then(function(response1) {
  // Create CODE HERE to Log the queryURL
  console.log(response1);
  var currentCity = response1.name;
  var currentDate = new Date(response1.dt * 1000);
  var dateMonth = currentDate.getMonth();
  var dateDay = currentDate.getDate();
  var dateYear = currentDate.getFullYear();
  $("#city-date").text(currentCity + " (" + (dateMonth + 1) + "/" + dateDay + "/" + dateYear + ")");
  var lon = response1.coord.lon;
  var lat = response1.coord.lat;
  weatherQuery(lon, lat);
});



  </script>
</body>

</html>